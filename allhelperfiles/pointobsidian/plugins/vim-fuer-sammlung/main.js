/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => VimSammlung
});
module.exports = __toCommonJS(main_exports);
var import_obsidian2 = require("obsidian");

// src/settings.ts
var import_obsidian = require("obsidian");
var VimSammlungSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Settings #1").setDesc("It's a secret").addText((text) => text.setPlaceholder("Enter your secret").setValue(this.plugin.settings.mySetting).onChange(async (value) => {
      this.plugin.settings.mySetting = value;
      await this.plugin.saveSettings();
    }));
  }
};

// src/main.ts
var DEFAULT_SETTINGS = {
  exmpSetting: "default",
  vimStatusPromptMap: {
    normal: "\u{1F7E2}",
    insert: "\u{1F7E0}",
    visual: "\u{1F7E1}",
    replace: "\u{1F534}"
  }
};
var vimStatusCssClass = "vim-sammlung-statusbar";
var VimSammlung = class extends import_obsidian2.Plugin {
  constructor() {
    super(...arguments);
    this.initialized = false;
    this.codeMirrorVimObject = null;
    this.vimChordStatusBar = null;
    this.vimStatusBar = null;
    this.currentVimStatus = "normal" /* normal */;
    this.isInsertMode = false;
    this.logVimModeChange = async (cm) => {
      console.log("logVimModeChange ");
      console.log(cm);
      if (!cm) return;
      this.isInsertMode = cm.mode === "insert";
      switch (cm.mode) {
        case "insert":
          this.currentVimStatus = "insert" /* insert */;
          break;
        case "normal":
          this.currentVimStatus = "normal" /* normal */;
          break;
        case "visual":
          this.currentVimStatus = "visual" /* visual */;
          break;
        case "replace":
          this.currentVimStatus = "replace" /* replace */;
          break;
        default:
          break;
      }
      this.updateVimStatusBar();
    };
  }
  getActiveView() {
    return this.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView);
  }
  getActiveObsidianEditor() {
    return this.getActiveView().editor;
  }
  getCodeMirror(view) {
    var _a, _b, _c;
    return (_c = (_b = (_a = view.editMode) == null ? void 0 : _a.editor) == null ? void 0 : _b.cm) == null ? void 0 : _c.cm;
  }
  prepareChordDisplay() {
    this.vimChordStatusBar = this.addStatusBarItem();
    let parent = this.vimChordStatusBar.parentElement;
    this.vimChordStatusBar.parentElement.insertBefore(this.vimChordStatusBar, parent.firstChild);
    this.vimChordStatusBar.style.marginRight = "auto";
    const view = this.getActiveView();
    if (!view) return;
  }
  prepareVimModeDisplay() {
    console.log("prepareVimModeDisplay");
    this.vimStatusBar = this.addStatusBarItem();
    let parent = this.vimStatusBar.parentElement;
    parent.insertBefore(this.vimStatusBar, parent.firstChild);
    this.vimStatusBar.addClass(vimStatusCssClass);
    this.vimStatusBar.style.marginRight = "auto";
    this.vimStatusBar.setText(
      this.settings.vimStatusPromptMap[this.currentVimStatus]
    );
    this.vimStatusBar.dataset.vimMode = this.currentVimStatus;
  }
  updateVimStatusBar() {
    console.log("updateVimStatusbar " + this.currentVimStatus);
    this.vimStatusBar.setText(
      this.settings.vimStatusPromptMap[this.currentVimStatus]
    );
    this.vimStatusBar.dataset.vimMode = this.currentVimStatus;
  }
  async updateVimEvents() {
    console.log("updateVimEvents");
    if (!this.app.isVimEnabled())
      return;
    console.log("vim is enabled");
    let view = this.getActiveView();
    if (view) {
      const cmEditor = this.getCodeMirror(view);
      this.isInsertMode = false;
      this.currentVimStatus = "normal" /* normal */;
      this.updateVimStatusBar();
      console.log("In updateVimEvents cmEditor: " + cmEditor);
      if (!cmEditor) return;
      cmEditor.off("vim-mode-change", this.logVimModeChange);
      cmEditor.on("vim-mode-change", this.logVimModeChange);
      this.currentKeyChord = [];
    }
  }
  async initialize() {
    var _a;
    if (this.initialized)
      return;
    this.codeMirrorVimObject = (_a = window.CodeMirrorAdapter) == null ? void 0 : _a.Vim;
    this.prepareChordDisplay();
    this.prepareVimModeDisplay();
    this.app.workspace.on("active-leaf-change", async () => {
      this.updateVimEvents();
    });
    this.app.workspace.on("file-open", async () => {
      this.updateVimEvents();
    });
    this.initialized = true;
  }
  async onload() {
    console.log("VimSammlung OnLoad");
    await this.loadSettings();
    await this.initialize();
    this.addRibbonIcon("dice", "VimSammlung", (evt) => {
      new import_obsidian2.Notice("HoHo!");
    });
    this.addCommand({
      id: "open-modal-simple",
      name: "Open modal (simple)",
      callback: () => {
        new VimSammlungModal(this.app).open();
      }
    });
    this.addCommand({
      id: "replace-selected",
      name: "Replace selected content",
      editorCallback: (editor, view) => {
        editor.replaceSelection("Beispiel fuer editor command");
      }
    });
    this.addCommand({
      id: "open-modal-complex",
      name: "Open modal (complex)",
      checkCallback: (checking) => {
        const markdownView = this.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView);
        if (markdownView) {
          if (!checking) {
            new VimSammlungModal(this.app).open();
          }
          return true;
        }
        return false;
      }
    });
    this.addSettingTab(new VimSammlungSettingTab(this.app, this));
    this.registerDomEvent(document, "click", (evt) => {
      ;
    });
    this.registerInterval(window.setInterval(() => console.log("setInterval"), 5 * 60 * 1e3));
    console.log("VimSammlung Loaded");
  }
  onunload() {
    console.log("VimSammlung OnUnload");
    this.vimStatusBar.remove();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
var VimSammlungModal = class extends import_obsidian2.Modal {
  constructor(app) {
    super(app);
  }
  onOpen() {
    let { contentEl } = this;
    contentEl.setText("Woah!");
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3NldHRpbmdzLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQge0FwcCwgRWRpdG9yLCBNYXJrZG93blZpZXcsIE1vZGFsLCBOb3RpY2UsIFBsdWdpbn0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgVmltU2FtbWx1bmdTZXR0aW5ncyxcbiAgICAgICAgIFZpbVNhbW1sdW5nU2V0dGluZ1RhYixcbiAgICAgICAgIFZpbVN0YXR1c1Byb21wdCAsXG4gICAgICAgICBWaW1TdGF0dXNQcm9tcHRNYXAsXG4gICAgICAgICB2aW1TdGF0dXNcbiAgICAgICAgfSBmcm9tICcuL3NldHRpbmdzJztcbmltcG9ydCB7IGRlZmluZUFuZE1hcE9ic2lkaWFuVmltQWN0aW9uLCBkZWZpbmVBbmRNYXBPYnNpZGlhblZpbU1vdGlvbiB9IGZyb20gJy4vdXRpbHMvb2JzaWRpYW5WaW1Db21tYW5kJztcbmltcG9ydCB7IFZpbUFwaSB9IGZyb20gJy4vdXRpbHMvdmltQXBpJztcblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogVmltU2FtbWx1bmdTZXR0aW5ncyA9IHtcbiAgZXhtcFNldHRpbmc6ICdkZWZhdWx0JyxcbiAgdmltU3RhdHVzUHJvbXB0TWFwOiB7XG4gICAgbm9ybWFsOiAgJ1x1RDgzRFx1REZFMicsXG4gICAgaW5zZXJ0OiAgJ1x1RDgzRFx1REZFMCcsXG4gICAgdmlzdWFsOiAgJ1x1RDgzRFx1REZFMScsXG4gICAgcmVwbGFjZTogJ1x1RDgzRFx1REQzNCcsXG4gIH0sXG59XG5jb25zdCB2aW1TdGF0dXNDc3NDbGFzcyA9IFwidmltLXNhbW1sdW5nLXN0YXR1c2JhclwiO1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmltU2FtbWx1bmcgZXh0ZW5kcyBQbHVnaW4ge1xuICBzZXR0aW5nczogVmltU2FtbWx1bmdTZXR0aW5ncztcbiAgcHJpdmF0ZSBpbml0aWFsaXplZCA9IGZhbHNlO1xuICBwcml2YXRlIGNvZGVNaXJyb3JWaW1PYmplY3Q6IGFueSA9IG51bGw7XG4gIHByaXZhdGUgdmltQ2hvcmRTdGF0dXNCYXI6IEhUTUxFbGVtZW50ID0gbnVsbDtcbiAgcHJpdmF0ZSB2aW1TdGF0dXNCYXI6IEhUTUxFbGVtZW50ID0gbnVsbDtcbiAgcHJpdmF0ZSBjdXJyZW50VmltU3RhdHVzOiB2aW1TdGF0dXMgPSB2aW1TdGF0dXMubm9ybWFsO1xuICBwcml2YXRlIGlzSW5zZXJ0TW9kZTogYm9vbGVhbiA9IGZhbHNlO1xuICBwcml2YXRlIGdldEFjdGl2ZVZpZXcoKTogTWFya2Rvd25WaWV3IHtcbiAgICByZXR1cm4gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgfVxuICBnZXRBY3RpdmVPYnNpZGlhbkVkaXRvcigpOiBPYnNpZGlhbkVkaXRvciB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QWN0aXZlVmlldygpLmVkaXRvcjtcbiAgfVxuICBwcml2YXRlIGdldENvZGVNaXJyb3IodmlldzogTWFya2Rvd25WaWV3KTogQ29kZU1pcnJvci5FZGl0b3Ige1xuICAgIHJldHVybiAodmlldyBhcyBhbnkpLmVkaXRNb2RlPy5lZGl0b3I/LmNtPy5jbTtcbiAgfVxuICBwcmVwYXJlQ2hvcmREaXNwbGF5KCkge1xuICAgIHRoaXMudmltQ2hvcmRTdGF0dXNCYXIgPSB0aGlzLmFkZFN0YXR1c0Jhckl0ZW0oKTtcblxuICAgIC8vIE1vdmUgdmltQ2hvcmRTdGF0dXNCYXIgdG8gdGhlIGxlZnRtb3N0IHBvc2l0aW9uIGFuZCBjZW50ZXIgaXQuXG4gICAgbGV0IHBhcmVudCA9IHRoaXMudmltQ2hvcmRTdGF0dXNCYXIucGFyZW50RWxlbWVudDtcbiAgICB0aGlzLnZpbUNob3JkU3RhdHVzQmFyLnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKHRoaXMudmltQ2hvcmRTdGF0dXNCYXIsIHBhcmVudC5maXJzdENoaWxkKTtcbiAgICB0aGlzLnZpbUNob3JkU3RhdHVzQmFyLnN0eWxlLm1hcmdpblJpZ2h0ID0gXCJhdXRvXCI7XG5cbiAgICBjb25zdCB2aWV3ID0gdGhpcy5nZXRBY3RpdmVWaWV3KCk7XG4gICAgaWYgKCF2aWV3KSByZXR1cm47XG4gICAgLy94eCBsZXQgY21FZGl0b3IgPSB0aGlzLmdldENvZGVNaXJyb3Iodmlldyk7XG4gICAgLy94eCBjbUVkaXRvci5vZmYoJ3ZpbS1rZXlwcmVzcycsIHRoaXMub25WaW1LZXlwcmVzcyk7XG4gICAgLy94eCBjbUVkaXRvci5vbigndmltLWtleXByZXNzJywgdGhpcy5vblZpbUtleXByZXNzKTtcbiAgICAvL3h4IGNtRWRpdG9yLm9mZigndmltLWNvbW1hbmQtZG9uZScsIHRoaXMub25WaW1Db21tYW5kRG9uZSk7XG4gICAgLy94eCBjbUVkaXRvci5vbigndmltLWNvbW1hbmQtZG9uZScsIHRoaXMub25WaW1Db21tYW5kRG9uZSk7XG4gIH1cbiAgcHJlcGFyZVZpbU1vZGVEaXNwbGF5KCkge1xuICAgIGNvbnNvbGUubG9nKFwicHJlcGFyZVZpbU1vZGVEaXNwbGF5XCIpXG4gICAgdGhpcy52aW1TdGF0dXNCYXIgPSB0aGlzLmFkZFN0YXR1c0Jhckl0ZW0oKVxuICAgIGxldCBwYXJlbnQgPSB0aGlzLnZpbVN0YXR1c0Jhci5wYXJlbnRFbGVtZW50O1xuICAgIHBhcmVudC5pbnNlcnRCZWZvcmUodGhpcy52aW1TdGF0dXNCYXIsIHBhcmVudC5maXJzdENoaWxkKTtcbiAgICB0aGlzLnZpbVN0YXR1c0Jhci5hZGRDbGFzcyh2aW1TdGF0dXNDc3NDbGFzcyk7XG4gICAgdGhpcy52aW1TdGF0dXNCYXIuc3R5bGUubWFyZ2luUmlnaHQgPSBcImF1dG9cIjtcblxuICAgIHRoaXMudmltU3RhdHVzQmFyLnNldFRleHQoXG4gICAgICB0aGlzLnNldHRpbmdzLnZpbVN0YXR1c1Byb21wdE1hcFt0aGlzLmN1cnJlbnRWaW1TdGF0dXNdXG4gICAgKTtcbiAgICB0aGlzLnZpbVN0YXR1c0Jhci5kYXRhc2V0LnZpbU1vZGUgPSB0aGlzLmN1cnJlbnRWaW1TdGF0dXM7XG4gIH1cbiAgdXBkYXRlVmltU3RhdHVzQmFyKCkge1xuICAgIGNvbnNvbGUubG9nKFwidXBkYXRlVmltU3RhdHVzYmFyIFwiICsgdGhpcy5jdXJyZW50VmltU3RhdHVzKVxuICAgIHRoaXMudmltU3RhdHVzQmFyLnNldFRleHQoXG4gICAgICB0aGlzLnNldHRpbmdzLnZpbVN0YXR1c1Byb21wdE1hcFt0aGlzLmN1cnJlbnRWaW1TdGF0dXNdXG4gICAgKTtcbiAgICB0aGlzLnZpbVN0YXR1c0Jhci5kYXRhc2V0LnZpbU1vZGUgPSB0aGlzLmN1cnJlbnRWaW1TdGF0dXM7XG4gIH1cbiAgbG9nVmltTW9kZUNoYW5nZSA9IGFzeW5jIChjbTogYW55KSA9PiB7XG4gICAgY29uc29sZS5sb2coXCJsb2dWaW1Nb2RlQ2hhbmdlIFwiKVxuICAgIGNvbnNvbGUubG9nKGNtKVxuICAgIGlmICghY20pIHJldHVybjtcbiAgICB0aGlzLmlzSW5zZXJ0TW9kZSA9IGNtLm1vZGUgPT09ICdpbnNlcnQnO1xuICAgIHN3aXRjaCAoY20ubW9kZSkge1xuICAgICAgY2FzZSBcImluc2VydFwiOlxuICAgICAgICB0aGlzLmN1cnJlbnRWaW1TdGF0dXMgPSB2aW1TdGF0dXMuaW5zZXJ0O1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJub3JtYWxcIjpcbiAgICAgICAgdGhpcy5jdXJyZW50VmltU3RhdHVzID0gdmltU3RhdHVzLm5vcm1hbDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwidmlzdWFsXCI6XG4gICAgICAgIHRoaXMuY3VycmVudFZpbVN0YXR1cyA9IHZpbVN0YXR1cy52aXN1YWw7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcInJlcGxhY2VcIjpcbiAgICAgICAgdGhpcy5jdXJyZW50VmltU3RhdHVzID0gdmltU3RhdHVzLnJlcGxhY2U7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIHRoaXMudXBkYXRlVmltU3RhdHVzQmFyKCk7XG4gIH1cbiAgYXN5bmMgdXBkYXRlVmltRXZlbnRzKCkge1xuICAgIGNvbnNvbGUubG9nKFwidXBkYXRlVmltRXZlbnRzXCIpXG4gICAgaWYgKCEodGhpcy5hcHAgYXMgQW55KS5pc1ZpbUVuYWJsZWQoKSlcbiAgICAgIHJldHVybjtcbiAgICBjb25zb2xlLmxvZyhcInZpbSBpcyBlbmFibGVkXCIpXG4gICAgbGV0IHZpZXcgPSB0aGlzLmdldEFjdGl2ZVZpZXcoKTtcbiAgICBpZiAodmlldykge1xuICAgICAgY29uc3QgY21FZGl0b3IgPSB0aGlzLmdldENvZGVNaXJyb3Iodmlldyk7XG5cbiAgICAgIC8vIFNlZSBodHRwczovL2NvZGVtaXJyb3IubmV0L2RvYy9tYW51YWwuaHRtbCN2aW1hcGlfZXZlbnRzIGZvciBldmVudHMuXG4gICAgICB0aGlzLmlzSW5zZXJ0TW9kZSA9IGZhbHNlO1xuICAgICAgdGhpcy5jdXJyZW50VmltU3RhdHVzID0gdmltU3RhdHVzLm5vcm1hbDtcbiAgICAgIHRoaXMudXBkYXRlVmltU3RhdHVzQmFyKCk7XG4gICAgICBjb25zb2xlLmxvZyhcIkluIHVwZGF0ZVZpbUV2ZW50cyBjbUVkaXRvcjogXCIgKyAgY21FZGl0b3IpXG4gICAgICBpZiAoIWNtRWRpdG9yKSByZXR1cm47XG4gICAgICBjbUVkaXRvci5vZmYoJ3ZpbS1tb2RlLWNoYW5nZScsIHRoaXMubG9nVmltTW9kZUNoYW5nZSk7XG4gICAgICBjbUVkaXRvci5vbigndmltLW1vZGUtY2hhbmdlJywgdGhpcy5sb2dWaW1Nb2RlQ2hhbmdlKTtcblxuICAgICAgdGhpcy5jdXJyZW50S2V5Q2hvcmQgPSBbXTtcbiAgICAgIC8veHggY21FZGl0b3Iub2ZmKCd2aW0ta2V5cHJlc3MnLCB0aGlzLm9uVmltS2V5cHJlc3MpO1xuICAgICAgLy94eCBjbUVkaXRvci5vbigndmltLWtleXByZXNzJywgdGhpcy5vblZpbUtleXByZXNzKTtcbiAgICAgIC8veHggY21FZGl0b3Iub2ZmKCd2aW0tY29tbWFuZC1kb25lJywgdGhpcy5vblZpbUNvbW1hbmREb25lKTtcbiAgICAgIC8veHggY21FZGl0b3Iub24oJ3ZpbS1jb21tYW5kLWRvbmUnLCB0aGlzLm9uVmltQ29tbWFuZERvbmUpO1xuICAgICAgLy94eCBDb2RlTWlycm9yLm9mZihjbUVkaXRvci5nZXRJbnB1dEZpZWxkKCksICdrZXlkb3duJywgdGhpcy5vbktleWRvd24pO1xuICAgICAgLy94eCBDb2RlTWlycm9yLm9uKGNtRWRpdG9yLmdldElucHV0RmllbGQoKSwgJ2tleWRvd24nLCB0aGlzLm9uS2V5ZG93bik7XG4gICAgfVxuICB9XG4gIGFzeW5jIGluaXRpYWxpemUoKSB7XG4gICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpXG4gICAgICByZXR1cm47XG5cbiAgICB0aGlzLmNvZGVNaXJyb3JWaW1PYmplY3QgPSAod2luZG93IGFzIGFueSkuQ29kZU1pcnJvckFkYXB0ZXI/LlZpbTtcblxuICAgIHRoaXMucHJlcGFyZUNob3JkRGlzcGxheSgpO1xuICAgIHRoaXMucHJlcGFyZVZpbU1vZGVEaXNwbGF5KCk7XG5cbiAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJhY3RpdmUtbGVhZi1jaGFuZ2VcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgdGhpcy51cGRhdGVWaW1FdmVudHMoKTtcbiAgICB9KTtcbiAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJmaWxlLW9wZW5cIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgdGhpcy51cGRhdGVWaW1FdmVudHMoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuICB9XG4gIGFzeW5jIG9ubG9hZCgpIHtcbiAgICBjb25zb2xlLmxvZyhcIlZpbVNhbW1sdW5nIE9uTG9hZFwiKVxuICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG4gICAgYXdhaXQgdGhpcy5pbml0aWFsaXplKCk7XG4gICAgdGhpcy5hZGRSaWJib25JY29uKCdkaWNlJywgJ1ZpbVNhbW1sdW5nJywgKGV2dDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgbmV3IE5vdGljZSgnSG9IbyEnKTtcbiAgICB9KTtcbiAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgaWQ6ICdvcGVuLW1vZGFsLXNpbXBsZScsXG4gICAgICBuYW1lOiAnT3BlbiBtb2RhbCAoc2ltcGxlKScsXG4gICAgICBjYWxsYmFjazogKCkgPT4ge1xuICAgICAgICBuZXcgVmltU2FtbWx1bmdNb2RhbCh0aGlzLmFwcCkub3BlbigpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICBpZDogJ3JlcGxhY2Utc2VsZWN0ZWQnLFxuICAgICAgbmFtZTogJ1JlcGxhY2Ugc2VsZWN0ZWQgY29udGVudCcsXG4gICAgICBlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcpID0+IHtcbiAgICAgICAgZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24oJ0JlaXNwaWVsIGZ1ZXIgZWRpdG9yIGNvbW1hbmQnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgaWQ6ICdvcGVuLW1vZGFsLWNvbXBsZXgnLFxuICAgICAgbmFtZTogJ09wZW4gbW9kYWwgKGNvbXBsZXgpJyxcbiAgICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuICAgICAgICBjb25zdCBtYXJrZG93blZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICBpZiAobWFya2Rvd25WaWV3KSB7XG4gICAgICAgICAgaWYgKCFjaGVja2luZykge1xuICAgICAgICAgICAgbmV3IFZpbVNhbW1sdW5nTW9kYWwodGhpcy5hcHApLm9wZW4oKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgVmltU2FtbWx1bmdTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG4gICAgdGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCAnY2xpY2snLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICA7IC8vbmV3IE5vdGljZShcIkNsaWNrXCIpO1xuICAgIH0pO1xuICAgIHRoaXMucmVnaXN0ZXJJbnRlcnZhbCh3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4gY29uc29sZS5sb2coJ3NldEludGVydmFsJyksIDUgKiA2MCAqIDEwMDApKTtcbiAgICBjb25zb2xlLmxvZyhcIlZpbVNhbW1sdW5nIExvYWRlZFwiKVxuICB9XG4gIG9udW5sb2FkKCkge1xuICAgIGNvbnNvbGUubG9nKFwiVmltU2FtbWx1bmcgT25VbmxvYWRcIilcbiAgICB0aGlzLnZpbVN0YXR1c0Jhci5yZW1vdmUoKVxuICB9XG4gIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpIGFzIFBhcnRpYWw8VmltU2FtbWx1bmdTZXR0aW5ncz4pO1xuICB9XG4gIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICB9XG59XG5cbmNsYXNzIFZpbVNhbW1sdW5nTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwKSB7XG4gICAgc3VwZXIoYXBwKTtcbiAgfVxuICBvbk9wZW4oKSB7XG4gICAgbGV0IHtjb250ZW50RWx9ID0gdGhpcztcbiAgICBjb250ZW50RWwuc2V0VGV4dCgnV29haCEnKTtcbiAgfVxuICBvbkNsb3NlKCkge1xuICAgIGNvbnN0IHtjb250ZW50RWx9ID0gdGhpcztcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgfVxufVxuIiwgImltcG9ydCB7QXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBWaW1TYW1tbHVuZyBmcm9tIFwiLi9tYWluXCI7XG5cbmV4cG9ydCBjb25zdCBlbnVtIHZpbVN0YXR1cyB7XG4gIG5vcm1hbCA9ICAnbm9ybWFsJyxcbiAgaW5zZXJ0ID0gICdpbnNlcnQnLFxuICB2aXN1YWwgPSAgJ3Zpc3VhbCcsXG4gIHJlcGxhY2UgPSAncmVwbGFjZScsXG59XG5leHBvcnQgdHlwZSBWaW1TdGF0dXNQcm9tcHQgPSBzdHJpbmc7XG5leHBvcnQgdHlwZSBWaW1TdGF0dXNQcm9tcHRNYXAgPSB7XG4gIFtzdGF0dXMgaW4gdmltU3RhdHVzXTogVmltU3RhdHVzUHJvbXB0O1xufTtcbmV4cG9ydCBpbnRlcmZhY2UgVmltU2FtbWx1bmdTZXR0aW5ncyB7XG4gIGV4bXBTZXR0aW5nOiBzdHJpbmc7XG4gIHZpbVN0YXR1c1Byb21wdE1hcDogVmltU3RhdHVzUHJvbXB0TWFwO1xufVxuXG5leHBvcnQgY2xhc3MgVmltU2FtbWx1bmdTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gIHBsdWdpbjogVmltU2FtbWx1bmc7XG5cbiAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogVmltU2FtbWx1bmcpIHtcbiAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gIH1cblxuICBkaXNwbGF5KCk6IHZvaWQge1xuICAgIGNvbnN0IHtjb250YWluZXJFbH0gPSB0aGlzO1xuXG4gICAgY29udGFpbmVyRWwuZW1wdHkoKTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoJ1NldHRpbmdzICMxJylcbiAgICAgIC5zZXREZXNjKCdJdFxcJ3MgYSBzZWNyZXQnKVxuICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgIC5zZXRQbGFjZWhvbGRlcignRW50ZXIgeW91ciBzZWNyZXQnKVxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubXlTZXR0aW5nKVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubXlTZXR0aW5nID0gdmFsdWU7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pKTtcbiAgfVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQUErRDs7O0FDQS9ELHNCQUE2QztBQWtCdEMsSUFBTSx3QkFBTixjQUFvQyxpQ0FBaUI7QUFBQSxFQUcxRCxZQUFZLEtBQVUsUUFBcUI7QUFDekMsVUFBTSxLQUFLLE1BQU07QUFDakIsU0FBSyxTQUFTO0FBQUEsRUFDaEI7QUFBQSxFQUVBLFVBQWdCO0FBQ2QsVUFBTSxFQUFDLFlBQVcsSUFBSTtBQUV0QixnQkFBWSxNQUFNO0FBRWxCLFFBQUksd0JBQVEsV0FBVyxFQUNwQixRQUFRLGFBQWEsRUFDckIsUUFBUSxlQUFnQixFQUN4QixRQUFRLFVBQVEsS0FDZCxlQUFlLG1CQUFtQixFQUNsQyxTQUFTLEtBQUssT0FBTyxTQUFTLFNBQVMsRUFDdkMsU0FBUyxPQUFPLFVBQVU7QUFDekIsV0FBSyxPQUFPLFNBQVMsWUFBWTtBQUNqQyxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDakMsQ0FBQyxDQUFDO0FBQUEsRUFDUjtBQUNGOzs7QURoQ0EsSUFBTSxtQkFBd0M7QUFBQSxFQUM1QyxhQUFhO0FBQUEsRUFDYixvQkFBb0I7QUFBQSxJQUNsQixRQUFTO0FBQUEsSUFDVCxRQUFTO0FBQUEsSUFDVCxRQUFTO0FBQUEsSUFDVCxTQUFTO0FBQUEsRUFDWDtBQUNGO0FBQ0EsSUFBTSxvQkFBb0I7QUFDMUIsSUFBcUIsY0FBckIsY0FBeUMsd0JBQU87QUFBQSxFQUFoRDtBQUFB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
